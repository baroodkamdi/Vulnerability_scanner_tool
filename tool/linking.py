#!/usr/bin/env python
from subprocess import*
import sys
import time
import os
import pyfiglet
ascii_banner = pyfiglet.figlet_format('Vulnerability Scanner')
print(160*'=')
print(ascii_banner)
result = pyfiglet.figlet_format("Tool")
print(result)
print(""" # Presented by #  Vaibhav Kamdi(barood)""")
print(160*'=')
print(80*'#')
print(160*'=')
print('Vulnerability Assemment Tool')
from yaspin import yaspin
with yaspin():
        time.sleep(1)
@yaspin(text="Loading....")
@yaspin(text="Please Wait....")
def some_operations():
        time.sleep(2)
some_operations()
some_operations()
print("1.API_Shodan")
print("2.Subdomain Scanning")
print("3.Open Port number")
print("4.Grabbing_Cookies")
print("5.SQL Injection")
print("6.XSS(cross-site Scripting)")
print("7.Broken-Authentication")
print("8.Exit")

#input choice
ch = 0
while ch is not True:
        try:
                ch = int(input("Enter your choice(1-8):"))
                if ch==1:
                        import shodan
                        import api_shodan as a
                        a.api_shodan()
                elif ch==2:
                        do = raw_input('Enter the Url :')
                        q=Popen([r'../tool/Sublist3r/sublist3r.py -d %s'%do ,"ArcView"],shell=True)
                        output=q.communicate()
                elif ch==3:
                        ps =Popen([r'../tool/ports12.py',"ArcView"],shell=True)
                        output=ps.communicate()
                elif ch==4:
                        gn = raw_input('Enter the Url : ')
                        go = Popen([r'../tool/Cookies/grabber.py --spider 1 -u %s'%gn ,"ArcView"],shell=True)
                        print("Grabbing cookies")
                elif ch==5:
                        #import sql as s1
                        p=Popen([r'../tool/sql.py',"ArcView"],shell=True)
                        output=p.communicate()
                        #print(output[0])
                        #chmod +x /root/final/sql.py
                        #python3 /root/final/sql.py
                        #s1.sql()
                elif ch==6:
                        import xss as x
                        x.xss()
                elif ch==7:
                        import broken as br
                        br.broken()
                elif ch==8:
                        print('Stay Secured!!!!')
                        sys.exit(0)
        except ValueError :
                print('Oops! That was not a valid option')
print(150*'=')
print(150*'#')
print(150*'=')
